<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 9 Line Graphs | A Simple Cookbook for Wrangling and Visualization</title>
<meta name="author" content="Bernard Liew">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 9 Line Graphs | A Simple Cookbook for Wrangling and Visualization">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 9 Line Graphs | A Simple Cookbook for Wrangling and Visualization">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.14/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet">
<script src="libs/font-awesome-5.13.0/js/script.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
<meta name="description" content="Line graphs are typically used for visualizing how one continuous variable, on the y-axis, changes in relation to another continuous variable, on the x-axis. Often the x variable represents time,...">
<meta property="og:description" content="Line graphs are typically used for visualizing how one continuous variable, on the y-axis, changes in relation to another continuous variable, on the x-axis. Often the x variable represents time,...">
<meta name="twitter:description" content="Line graphs are typically used for visualizing how one continuous variable, on the y-axis, changes in relation to another continuous variable, on the x-axis. Often the x variable represents time,...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Simple Cookbook for Wrangling and Visualization</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Preface</a></li>
<li><a class="" href="get-started.html"><span class="header-section-number">2</span> Getting Started</a></li>
<li><a class="" href="basics.html"><span class="header-section-number">3</span> The Basics</a></li>
<li><a class="" href="NavigatingTheSoftware.html"><span class="header-section-number">4</span> Navigating the Software</a></li>
<li><a class="" href="InputOuput.html"><span class="header-section-number">5</span> Input and Output</a></li>
<li><a class="" href="WRANGLE.html"><span class="header-section-number">6</span> Data manipulation - part 1</a></li>
<li><a class="" href="WRANGLE2.html"><span class="header-section-number">7</span> Data manipulation - part 2</a></li>
<li><a class="" href="CHAPTER-BAR-GRAPH.html"><span class="header-section-number">8</span> Bar Graphs</a></li>
<li><a class="active" href="line-graphs.html"><span class="header-section-number">9</span> Line Graphs</a></li>
<li><a class="" href="your-assignment.html"><span class="header-section-number">10</span> Your Assignment</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/bernard-liew/se201_stats_book/tree/2021_version">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="line-graphs" class="section level1" number="9">
<h1>
<span class="header-section-number">9</span> Line Graphs<a class="anchor" aria-label="anchor" href="#line-graphs"><i class="fas fa-link"></i></a>
</h1>
<p>Line graphs are typically used for visualizing how one continuous variable, on the y-axis, changes in relation to another continuous variable, on the x-axis. Often the <em>x</em> variable represents time, but it may also represent some other continuous quantity, for example, the amount of a drug administered to experimental subjects.</p>
<p>As with bar graphs, there are exceptions. Line graphs can also be used with a discrete variable on the x-axis. This is appropriate when the variable is ordered (e.g., “small”, “medium”, “large”), but not when the variable is unordered (e.g., “cow”, “goose”, “pig”). Most of the examples in this chapter use a continuous <em>x</em> variable, but we’ll see one example where the variable is converted to a factor and thus treated as a discrete variable.</p>
<p>Let us prepare for this chapter by first importing a Vo2 treadmill test data that we have cleaned, and placed in the data folder. See Recipe <a href="WRANGLE2.html#WRANGLE2-SUMMARIZE-GROUPBY">7.8</a>. The Excel sheet is called <code>"treadmill_pt4_clean.xlsx"</code>.</p>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span>  <span class="fu">read.xlsx</span> <span class="op">(</span>xlsxFile <span class="op">=</span> <span class="st">"data/treadmill_pt4_clean.xlsx"</span>,</span>
<span>                   sheet <span class="op">=</span> <span class="st">"Sheet1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span> <span class="op">(</span>stage <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/cut_interval.html">cut_interval</a></span><span class="op">(</span><span class="va">time</span>, length <span class="op">=</span> <span class="fl">210</span>, labels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">stage</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span> <span class="op">(</span>row_id <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span> <span class="op">(</span><span class="va">row_id</span> <span class="op">&lt;</span> <span class="fl">37</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_tail</a></span> <span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarise_at</a></span> <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">bf</span><span class="op">:</span><span class="va">hr</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span></span></code></pre></div>
<div id="LINE-GRAPH-BASIC-LINE" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Making a Basic Line Graph<a class="anchor" aria-label="anchor" href="#LINE-GRAPH-BASIC-LINE"><i class="fas fa-link"></i></a>
</h2>
<div class="vembedr">
<div>
<iframe src="https://www.youtube.com/embed/m0rdWRnWgc8" width="711" height="400" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<div id="problem-23" class="section level3" number="9.1.1">
<h3>
<span class="header-section-number">9.1.1</span> Problem<a class="anchor" aria-label="anchor" href="#problem-23"><i class="fas fa-link"></i></a>
</h3>
<p>You want to make a basic line graph.</p>
</div>
<div id="solution-23" class="section level3" number="9.1.2">
<h3>
<span class="header-section-number">9.1.2</span> Solution<a class="anchor" aria-label="anchor" href="#solution-23"><i class="fas fa-link"></i></a>
</h3>
<p>Use <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> with <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code>, and specify which variables you mapped to x and y (Figure <a href="line-graphs.html#fig:FIG-LINE-GRAPH-BASIC-LINE">9.1</a>):</p>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">stage</span>, y <span class="op">=</span> <span class="va">vo2</span><span class="op">)</span><span class="op">)</span>  </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:FIG-LINE-GRAPH-BASIC-LINE"></span>
<img src="se201_stats_book_files/figure-html/FIG-LINE-GRAPH-BASIC-LINE-1.png" alt="Basic line graph" width="50%"><p class="caption">
Figure 9.1: Basic line graph
</p>
</div>
</div>
<div id="discussion-12" class="section level3" number="9.1.3">
<h3>
<span class="header-section-number">9.1.3</span> Discussion<a class="anchor" aria-label="anchor" href="#discussion-12"><i class="fas fa-link"></i></a>
</h3>
<p>In this sample data set, the <em>x</em> variable, <code>time</code>, is in one column and the <em>y</em> variable, <code>vo2</code>, is in another:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:right;">
stage
</th>
<th style="text-align:right;">
bf
</th>
<th style="text-align:right;">
vo2_norm
</th>
<th style="text-align:right;">
rer
</th>
<th style="text-align:right;">
vo2
</th>
<th style="text-align:right;">
vco2
</th>
<th style="text-align:right;">
ve
</th>
<th style="text-align:right;">
hr
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
30.67
</td>
<td style="text-align:right;">
31.97
</td>
<td style="text-align:right;">
0.87
</td>
<td style="text-align:right;">
2052.83
</td>
<td style="text-align:right;">
1777.83
</td>
<td style="text-align:right;">
55.17
</td>
<td style="text-align:right;">
136.50
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
34.67
</td>
<td style="text-align:right;">
34.60
</td>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;">
2222.17
</td>
<td style="text-align:right;">
1957.50
</td>
<td style="text-align:right;">
59.33
</td>
<td style="text-align:right;">
147.00
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
34.67
</td>
<td style="text-align:right;">
37.42
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
2401.83
</td>
<td style="text-align:right;">
2191.33
</td>
<td style="text-align:right;">
66.67
</td>
<td style="text-align:right;">
161.33
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
38.00
</td>
<td style="text-align:right;">
37.83
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
2429.00
</td>
<td style="text-align:right;">
2312.50
</td>
<td style="text-align:right;">
71.17
</td>
<td style="text-align:right;">
172.17
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
44.00
</td>
<td style="text-align:right;">
41.67
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
2675.00
</td>
<td style="text-align:right;">
2686.00
</td>
<td style="text-align:right;">
85.67
</td>
<td style="text-align:right;">
178.50
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
45.67
</td>
<td style="text-align:right;">
43.85
</td>
<td style="text-align:right;">
1.06
</td>
<td style="text-align:right;">
2813.67
</td>
<td style="text-align:right;">
2981.17
</td>
<td style="text-align:right;">
99.83
</td>
<td style="text-align:right;">
185.83
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
54.50
</td>
<td style="text-align:right;">
45.50
</td>
<td style="text-align:right;">
1.09
</td>
<td style="text-align:right;">
2920.17
</td>
<td style="text-align:right;">
3195.83
</td>
<td style="text-align:right;">
110.33
</td>
<td style="text-align:right;">
192.33
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
57.33
</td>
<td style="text-align:right;">
45.48
</td>
<td style="text-align:right;">
1.05
</td>
<td style="text-align:right;">
2910.83
</td>
<td style="text-align:right;">
3068.83
</td>
<td style="text-align:right;">
112.17
</td>
<td style="text-align:right;">
195.17
</td>
</tr>
</tbody>
</table></div>
<p>With ggplot2, the default <em>y</em> range of a line graph is just enough to include the <em>y</em> values in the data. For some kinds of data, it’s better to have the <em>y</em> range start from zero. You can use <code><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim()</a></code> to set the range, or you can use <code><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html">expand_limits()</a></code> to expand the range to include a value. This will set the range from zero to the maximum value of the demand column in <code>BOD</code> (Figure <a href="line-graphs.html#fig:FIG-LINE-GRAPH-BASIC-LINE-YLIM">9.2</a>):</p>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># These have the same result</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">stage</span>, y <span class="op">=</span> <span class="va">vo2</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">vo2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">stage</span>, y <span class="op">=</span> <span class="va">vo2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html">expand_limits</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:FIG-LINE-GRAPH-BASIC-LINE-YLIM"></span>
<img src="se201_stats_book_files/figure-html/FIG-LINE-GRAPH-BASIC-LINE-YLIM-1.png" alt="Line graph with manually set y range" width="50%"><p class="caption">
Figure 9.2: Line graph with manually set y range
</p>
</div>
</div>
</div>
<div id="LINE-GRAPH-MULTIPLE-LINE" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> Making a Line Graph with Multiple Lines<a class="anchor" aria-label="anchor" href="#LINE-GRAPH-MULTIPLE-LINE"><i class="fas fa-link"></i></a>
</h2>
<div class="vembedr">
<div>
<iframe src="https://www.youtube.com/embed/VlyE4ZB0RPM" width="711" height="400" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<div id="problem-24" class="section level3" number="9.2.1">
<h3>
<span class="header-section-number">9.2.1</span> Problem<a class="anchor" aria-label="anchor" href="#problem-24"><i class="fas fa-link"></i></a>
</h3>
<p>You want to make a line graph with more than one line.</p>
</div>
<div id="solution-24" class="section level3" number="9.2.2">
<h3>
<span class="header-section-number">9.2.2</span> Solution<a class="anchor" aria-label="anchor" href="#solution-24"><i class="fas fa-link"></i></a>
</h3>
<p>In addition to the variables mapped to the x- and y-axes, map another (discrete) variable to colour or linetype, as shown in Figure <a href="line-graphs.html#fig:FIG-LINE-GRAPH-MULTI-LINE-COLOR-TYPE">9.3</a>:</p>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Bring all variables into one column</span></span>
<span></span>
<span><span class="va">dat_long</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span> <span class="op">(</span><span class="va">stage</span>, <span class="va">vo2</span>, <span class="va">vco2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">vo2</span><span class="op">:</span><span class="va">vco2</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"var"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"val"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span> <span class="op">(</span>var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span> <span class="op">(</span><span class="va">var</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Map supp to colour</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat_long</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">stage</span>, y <span class="op">=</span> <span class="va">val</span>, colour <span class="op">=</span> <span class="va">var</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Map supp to linetype</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat_long</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">stage</span>, y <span class="op">=</span> <span class="va">val</span>, linetype <span class="op">=</span> <span class="va">var</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:FIG-LINE-GRAPH-MULTI-LINE-COLOR-TYPE"></span>
<img src="se201_stats_book_files/figure-html/FIG-LINE-GRAPH-MULTI-LINE-COLOR-TYPE-1.png" alt="A variable mapped to colour (left); A variable mapped to linetype (right)" width="50%"><img src="se201_stats_book_files/figure-html/FIG-LINE-GRAPH-MULTI-LINE-COLOR-TYPE-2.png" alt="A variable mapped to colour (left); A variable mapped to linetype (right)" width="50%"><p class="caption">
Figure 9.3: A variable mapped to colour (left); A variable mapped to linetype (right)
</p>
</div>
</div>
<div id="discussion-13" class="section level3" number="9.2.3">
<h3>
<span class="header-section-number">9.2.3</span> Discussion<a class="anchor" aria-label="anchor" href="#discussion-13"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>dat_long</code> data has three columns, including the factor <code>var</code>, which we mapped to <code>colour</code> and <code>linetype</code>:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:right;">
stage
</th>
<th style="text-align:left;">
var
</th>
<th style="text-align:right;">
val
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
vo2
</td>
<td style="text-align:right;">
2052.83
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
vco2
</td>
<td style="text-align:right;">
1777.83
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
vo2
</td>
<td style="text-align:right;">
2222.17
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
vco2
</td>
<td style="text-align:right;">
1957.50
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
vo2
</td>
<td style="text-align:right;">
2401.83
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
vco2
</td>
<td style="text-align:right;">
2191.33
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
vo2
</td>
<td style="text-align:right;">
2429.00
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
vco2
</td>
<td style="text-align:right;">
2312.50
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
vo2
</td>
<td style="text-align:right;">
2675.00
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
vco2
</td>
<td style="text-align:right;">
2686.00
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
vo2
</td>
<td style="text-align:right;">
2813.67
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
vco2
</td>
<td style="text-align:right;">
2981.17
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
vo2
</td>
<td style="text-align:right;">
2920.17
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
vco2
</td>
<td style="text-align:right;">
3195.83
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
vo2
</td>
<td style="text-align:right;">
2910.83
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
vco2
</td>
<td style="text-align:right;">
3068.83
</td>
</tr>
</tbody>
</table></div>
<blockquote>
<p><strong>Note</strong></p>
<p>If the <em>x</em> variable is a factor, you must also tell ggplot to group by that same variable, as described below.</p>
</blockquote>
<p>Line graphs can be used with a continuous or categorical variable on the x-axis. Sometimes the variable mapped to the x-axis is <em>conceived</em> of as being categorical, even when it’s stored as a number. In the example here, there are eight values of stage: 1, 2, 3, 4, 5, 6, 7, 8. You may want to treat these as categories rather than values on a continuous scale. To do this, convert <code>stage</code> to a factor (Figure <a href="line-graphs.html#fig:FIG-LINE-GRAPH-MULTI-LINE-FACTOR">9.4</a>):</p>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat_long</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span> <span class="op">(</span><span class="va">stage</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">val</span>, colour <span class="op">=</span> <span class="va">var</span>, group <span class="op">=</span> <span class="va">var</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:FIG-LINE-GRAPH-MULTI-LINE-FACTOR"></span>
<img src="se201_stats_book_files/figure-html/FIG-LINE-GRAPH-MULTI-LINE-FACTOR-1.png" alt="Line graph with continuous x variable converted to a factor" width="50%"><p class="caption">
Figure 9.4: Line graph with continuous x variable converted to a factor
</p>
</div>
<p>To convert a variable to a factor , see also Recipe <a href="WRANGLE2.html#WRANGLE2-CHARACTERS-2-FACTORS">7.4</a>.</p>
<p>Notice the use of <code>group = var</code>. Without this statement, ggplot won’t know how to group the data together to draw the lines, and it will not plot anything:</p>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat_long</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span> <span class="op">(</span><span class="va">stage</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">val</span>, colour <span class="op">=</span> <span class="va">var</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; geom_path: Each group consists of only one observation. Do you need to adjust</span></span>
<span><span class="co">#&gt; the group aesthetic?</span></span></code></pre></div>
<div class="inline-figure"><img src="se201_stats_book_files/figure-html/unnamed-chunk-189-1.png" width="50%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="LINE-GRAPH-LINE-APPEARANCE" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> Changing the Appearance of Lines<a class="anchor" aria-label="anchor" href="#LINE-GRAPH-LINE-APPEARANCE"><i class="fas fa-link"></i></a>
</h2>
<div class="vembedr">
<div>
<iframe src="https://www.youtube.com/embed/xOWAMHWUxC4" width="711" height="400" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<div id="problem-25" class="section level3" number="9.3.1">
<h3>
<span class="header-section-number">9.3.1</span> Problem<a class="anchor" aria-label="anchor" href="#problem-25"><i class="fas fa-link"></i></a>
</h3>
<p>You want to change the appearance of the lines in a line graph.</p>
</div>
<div id="solution-25" class="section level3" number="9.3.2">
<h3>
<span class="header-section-number">9.3.2</span> Solution<a class="anchor" aria-label="anchor" href="#solution-25"><i class="fas fa-link"></i></a>
</h3>
<p>The type of line (solid, dashed, dotted, etc.) is set with <code>linetype</code>, the thickness (in mm) with <code>size</code>, and the color of the line with <code>colour</code> (or <code>color</code>).</p>
<p>These properties can be set (as shown in Figure <a href="line-graphs.html#fig:FIG-BAR-GRAPH-BASIC-LINE-CUSTOMIZED">9.5</a>) by passing them values in the call to <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code>:</p>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">stage</span>, y <span class="op">=</span> <span class="va">vo2</span><span class="op">)</span>, </span>
<span>            linetype <span class="op">=</span> <span class="st">"dashed"</span>, size <span class="op">=</span> <span class="fl">1</span>, colour <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:FIG-BAR-GRAPH-BASIC-LINE-CUSTOMIZED"></span>
<img src="se201_stats_book_files/figure-html/FIG-BAR-GRAPH-BASIC-LINE-CUSTOMIZED-1.png" alt="Line graph with custom linetype, size, and colour" width="50%"><p class="caption">
Figure 9.5: Line graph with custom linetype, size, and colour
</p>
</div>
<p>If there is more than one line, setting the aesthetic properties will affect all of the lines. On the other hand, <em>mapping</em> variables to the properties, as we saw in Recipe <a href="line-graphs.html#LINE-GRAPH-MULTIPLE-LINE">9.2</a>, will result in each line looking different. The default colors aren’t the most appealing, so you may want to use a different palette, as shown in Figure <a href="line-graphs.html#fig:FIG-LINE-GRAPH-MULTI-LINE-PALETTE">9.6</a>, by using <code><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_colour_brewer()</a></code> or <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_colour_manual()</a></code>:</p>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat_long</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">stage</span>, y <span class="op">=</span> <span class="va">val</span>, colour <span class="op">=</span> <span class="va">var</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:FIG-LINE-GRAPH-MULTI-LINE-PALETTE"></span>
<img src="se201_stats_book_files/figure-html/FIG-LINE-GRAPH-MULTI-LINE-PALETTE-1.png" alt="Using a palette from RColorBrewer" width="50%"><p class="caption">
Figure 9.6: Using a palette from RColorBrewer
</p>
</div>
</div>
<div id="discussion-14" class="section level3" number="9.3.3">
<h3>
<span class="header-section-number">9.3.3</span> Discussion<a class="anchor" aria-label="anchor" href="#discussion-14"><i class="fas fa-link"></i></a>
</h3>
<p>To set a single constant color for all the lines, specify colour outside of <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>. The same works for size, linetype, and point shape (Figure <a href="line-graphs.html#fig:FIG-LINE-GRAPH-MULTI-LINE-CONSTANT-AES">9.7</a>). You may also have to specify the grouping variable:</p>

<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># If both lines have the same properties, you need to specify a variable to</span></span>
<span><span class="co"># use for grouping</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat_long</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">stage</span>, y <span class="op">=</span> <span class="va">val</span>, group <span class="op">=</span> <span class="va">var</span><span class="op">)</span>,</span>
<span>            colour <span class="op">=</span> <span class="st">"darkgreen"</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Since supp is mapped to colour, it will automatically be used for grouping</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat_long</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">stage</span>, y <span class="op">=</span> <span class="va">val</span>, colour <span class="op">=</span> <span class="va">var</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">stage</span>, y <span class="op">=</span> <span class="va">val</span>, colour <span class="op">=</span> <span class="va">var</span><span class="op">)</span>,shape <span class="op">=</span> <span class="fl">22</span>, size <span class="op">=</span> <span class="fl">3</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:FIG-LINE-GRAPH-MULTI-LINE-CONSTANT-AES"></span>
<img src="se201_stats_book_files/figure-html/FIG-LINE-GRAPH-MULTI-LINE-CONSTANT-AES-1.png" alt="Line graph with constant size and color (left); With supp mapped to colour, and with points added (right)" width="50%"><img src="se201_stats_book_files/figure-html/FIG-LINE-GRAPH-MULTI-LINE-CONSTANT-AES-2.png" alt="Line graph with constant size and color (left); With supp mapped to colour, and with points added (right)" width="50%"><p class="caption">
Figure 9.7: Line graph with constant size and color (left); With <code>supp</code> mapped to <code>colour</code>, and with points added (right)
</p>
</div>
<p>The range of different linetypes that is available can be seen in (Figure <a href="line-graphs.html#fig:FIG-LINETYPE-AES">9.8</a>)</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:FIG-LINETYPE-AES"></span>
<img src="images/chapter-7/linetype.png" alt="The different types of linetype you can use." width="50%"><p class="caption">
Figure 9.8: The different types of linetype you can use.
</p>
</div>
</div>
</div>
<div id="LINE-GRAPH-APPEARANCE-THEME" class="section level2" number="9.4">
<h2>
<span class="header-section-number">9.4</span> Using Themes to Change Overall Appearance of Plot<a class="anchor" aria-label="anchor" href="#LINE-GRAPH-APPEARANCE-THEME"><i class="fas fa-link"></i></a>
</h2>
<div class="vembedr">
<div>
<iframe src="https://www.youtube.com/embed/IpmG8N8u6lw" width="711" height="400" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<div id="problem-26" class="section level3" number="9.4.1">
<h3>
<span class="header-section-number">9.4.1</span> Problem<a class="anchor" aria-label="anchor" href="#problem-26"><i class="fas fa-link"></i></a>
</h3>
<p>You want to use premade themes to control the overall plot appearance.</p>
</div>
<div id="solution-26" class="section level3" number="9.4.2">
<h3>
<span class="header-section-number">9.4.2</span> Solution<a class="anchor" aria-label="anchor" href="#solution-26"><i class="fas fa-link"></i></a>
</h3>
<p>There are many premade themes that are already included in ggplot2. The default ggplot2 theme is <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_grey()</a></code>, but the examples below also showcase <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw()</a></code>, <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal()</a></code>, and <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic()</a></code>.</p>
<p>To use a premade theme, add <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw()</a></code> or another theme to your plot (Figure <a href="line-graphs.html#fig:FIG-APPEARANCE-THEME">9.9</a>):</p>

<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create the base plot</span></span>
<span></span>
<span><span class="va">hw_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">stage</span>, y <span class="op">=</span> <span class="va">vo2</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Grey theme (the default)</span></span>
<span></span>
<span><span class="va">hw_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_grey</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Black-and-white theme</span></span>
<span></span>
<span><span class="va">hw_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Minimal theme without background annotations</span></span>
<span></span>
<span><span class="va">hw_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Classic theme, with axis lines but no gridlines</span></span>
<span></span>
<span><span class="va">hw_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:FIG-APPEARANCE-THEME"></span>
<img src="se201_stats_book_files/figure-html/FIG-APPEARANCE-THEME-1.png" alt="Scatter plot with theme_grey() (the default, top left); with theme_bw() (top right); with theme_minimal() (bottom left); with theme_classic() (bottom right)" width="50%"><img src="se201_stats_book_files/figure-html/FIG-APPEARANCE-THEME-2.png" alt="Scatter plot with theme_grey() (the default, top left); with theme_bw() (top right); with theme_minimal() (bottom left); with theme_classic() (bottom right)" width="50%"><img src="se201_stats_book_files/figure-html/FIG-APPEARANCE-THEME-3.png" alt="Scatter plot with theme_grey() (the default, top left); with theme_bw() (top right); with theme_minimal() (bottom left); with theme_classic() (bottom right)" width="50%"><img src="se201_stats_book_files/figure-html/FIG-APPEARANCE-THEME-4.png" alt="Scatter plot with theme_grey() (the default, top left); with theme_bw() (top right); with theme_minimal() (bottom left); with theme_classic() (bottom right)" width="50%"><p class="caption">
Figure 9.9: Scatter plot with <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_grey()</a></code> (the default, top left); with <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw()</a></code> (top right); with <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal()</a></code> (bottom left); with <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic()</a></code> (bottom right)
</p>
</div>
</div>
</div>
<div id="LINE-GRAPH-LEARNING-CHECK" class="section level2" number="9.5">
<h2>
<span class="header-section-number">9.5</span> Learning check<a class="anchor" aria-label="anchor" href="#LINE-GRAPH-LEARNING-CHECK"><i class="fas fa-link"></i></a>
</h2>
<div class="vembedr">
<div>
<iframe src="https://www.youtube.com/embed/7M5_GRm6bYM" width="711" height="400" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<ol style="list-style-type: decimal">
<li><p>From your learning check in <a href="CHAPTER-BAR-GRAPH.html#BAR-LEARNING-CHECK">8.9</a>, open up your <code>practice_script.R</code>.</p></li>
<li><p>Import the Excel file <code>data/Athlete_1_treadmill.xlsx</code>, and the sheet <code>raw</code>, and assign it to an object <code>dat</code>. See Recipe <a href="InputOuput.html#INPUT-IMPORT">5.2</a>. Also import the the sheet <code>stage</code> from the same file, and assign it to an object <code>dat_stage</code>.</p></li>
<li><p>Rename the columns of <code>dat</code> to be <code>("time", "bf", "vo2_norm", "rer", "vo2", "vco2", "ve", "hr")</code>, respectively. See Recipe <a href="WRANGLE.html#WRANGLE-RENAME-VARIABLES">6.2</a>.</p></li>
<li><p>Remove the first row of the <code>dat</code> data, as it is useless. See Recipe <a href="WRANGLE.html#WRANGLE-SLICE">6.3</a>.</p></li>
<li><p>Convert the variable <code>time</code> of <code>dat</code> into numeric seconds, and all other variables to numeric. See Recipe <a href="WRANGLE.html#WRANGLE-CHARACTER-2-TIME">6.6</a> and <a href="WRANGLE.html#WRANGLE-CHARACTER-2-NUMERIC">6.5</a>, respectively.</p></li>
<li><p>Create a variable called <code>stage</code>, where each stage represents 3:30 min worth of VO2 data. See Recipe <a href="WRANGLE.html#WRANGLE-NUMERIC-CATEGORY">6.7</a>.</p></li>
<li><p>For each stage, create a variable called <code>row_id</code>, which essentially represents the number of 5 sec windows in each stage. See Recipe <a href="WRANGLE2.html#WRANGLE2-NEW-VARIABLES">7.5</a> and <a href="WRANGLE2.html#WRANGLE2-SUMMARIZE-GROUPBY">7.8</a>.</p></li>
<li><p>For each stage, remove the data between 3 to 3:30min. See Recipe <a href="WRANGLE2.html#WRANGLE2-SUMMARIZE-GROUPBY">7.8</a> and <a href="WRANGLE2.html#WRANGLE2-FILTER-KEEP-NUMERIC">7.6.2</a>.</p></li>
<li><p>For each stage, keep the last six rows of data. See Recipe <a href="WRANGLE2.html#WRANGLE2-SUMMARIZE-GROUPBY">7.8</a> and <a href="WRANGLE.html#WRANGLE-SLICE">6.3</a>.</p></li>
<li><p>For each stage, calculate for all variables for the mean of the last six rows of data. See Recipe <a href="WRANGLE2.html#WRANGLE2-SUMMARIZE-GROUPBY">7.8</a> and <a href="WRANGLE2.html#WRANGLE2-SUMMARIZE-GLOBAL">7.7</a>. Assign this table to an object called <code>dat_summ</code>.</p></li>
<li><p>Merge the two tables <code>dat_summ</code> and <code>dat_stage</code>, by the common variable called <code>stage</code>. See Recipe <a href="WRANGLE2.html#WRANGLE2-INNER-JOIN">7.9</a>. Assign this table to an object called <code>df_plot</code>.</p></li>
<li><p>Using <code>df_plot</code>, make a line plot with with <code>speed</code> as the <em>x</em> axis, and <code>vo2</code> as the <em>y</em> axis, and assign it to an object called <code>f</code>. See Recipe <a href="line-graphs.html#LINE-GRAPH-BASIC-LINE">9.1</a>.</p></li>
<li><p>Save image <code>f</code> to a file called <code>myfig.png</code>. See Recipe <a href="CHAPTER-BAR-GRAPH.html#BAR-OUTPUT-BITMAP">8.8</a>.</p></li>
<li><p>You must be wondering, why can’t I see the figure. What must you do to print the picture? See Recipe <a href="get-started.html#INSTALL-READ-WRITE-CODE">2.3</a>.</p></li>
<li><p>Download the solution to this learning check below.</p></li>
</ol>
<a onclick="fetch('data:text/plain;base64,IyBMb2FkIHBhY2thZ2VzDQoNCmlmICghcmVxdWlyZSgicGFjbWFuIikpIGluc3RhbGwucGFja2FnZXMoInBhY21hbiIpDQpwYWNtYW46OnBfbG9hZCh0aWR5dmVyc2UsICMgQWxsIHB1cnBvc2Ugd3JhbmdsaW5nIGZvciBkYXRhZnJhbWVzDQogICAgICAgICAgICAgICBvcGVueGxzeCwjIHdyaXRpbmcgZXhjZWwgZG9jdW1lbnRzDQogICAgICAgICAgICAgICBsdWJyaWRhdGUsIyBkYXRlLXRpbWUgDQogICAgICAgICAgICAgICB0aWJibGV0aW1lKSAjIG1vdmluZyBhdmVyYWdlIGZvciB2bzINCg0KIyBJbXBvcnQgZXhjZWwgZGF0YQ0KDQpkYXQgPC0gIHJlYWQueGxzeCAoeGxzeEZpbGUgPSAiZGF0YS9BdGhsZXRlXzFfdHJlYWRtaWxsLnhsc3giLA0KICAgICAgICAgICAgICAgICAgICBzaGVldCA9ICJyYXciKQ0KDQpkYXRfc3RhZ2UgPC0gIHJlYWQueGxzeCAoeGxzeEZpbGUgPSAiZGF0YS9BdGhsZXRlXzFfdHJlYWRtaWxsLnhsc3giLA0KICAgICAgICAgICAgICAgICAgIHNoZWV0ID0gInN0YWdlIikNCg0KZGF0X2ZtcyA8LSAgcmVhZC54bHN4ICh4bHN4RmlsZSA9ICJkYXRhL0F0aGxldGVfMV9GTVMueGxzeCIsDQogICAgICAgICAgICAgICAgICAgc2hlZXQgPSAiU2hlZXQxIikNCg0KZGF0X2Ztc19ncnAgPC0gIHJlYWQueGxzeCAoeGxzeEZpbGUgPSAiZGF0YS9zaW1GTVMueGxzeCIsDQogICAgICAgICAgICAgICAgICAgc2hlZXQgPSAiRk1TIikNCg0KIyBUaWR5IGRhdGENCg0KIyMgUmVuYW1lIGNvbHVtbnMNCm5hbWVzIChkYXQpIDwtIGMoInRpbWUiLCAiYmYiLCAidm8yX25vcm0iLCAicmVyIiwgInZvMiIsICJ2Y28yIiwgInZlIiwgImhyIikNCg0KIyMgU2xpY2Ugb2ZmIGZpcnN0IHJvdw0KDQpkYXQgPC0gZGF0JT4lIA0KICBzbGljZSAoLTEpIA0KDQojIyBNYWtlIG51bWVyaWMgYW5kIHRpbWUNCg0KZGF0IDwtIGRhdCAlPiUNCiAgbXV0YXRlIChiZiA9IGFzLm51bWVyaWMoYmYpLA0KICAgICAgICAgIHZvMl9ub3JtID0gYXMubnVtZXJpYyh2bzJfbm9ybSksDQogICAgICAgICAgcmVyID0gYXMubnVtZXJpYyhyZXIpLA0KICAgICAgICAgIHZvMiA9IGFzLm51bWVyaWModm8yKSwNCiAgICAgICAgICB2Y28yID0gYXMubnVtZXJpYyh2Y28yKSwNCiAgICAgICAgICB2ZSA9IGFzLm51bWVyaWModmUpLA0KICAgICAgICAgIGhyID0gYXMubnVtZXJpYyhocikpICU+JQ0KICBtdXRhdGUgKHRpbWUgPSB0aW1lICU+JSANCiAgICAgICAgICAgIHN0cl9zcXVpc2goKSAlPiUgIyBmdW5jdGlvbiBzdHJpcHMgYW55IHdoaXRlc3BhY2VzDQogICAgICAgICAgICBtcygpICU+JSAjIGNvbnZlcnQgdG8gbWludXRlcyBhbmQgc2Vjb25kcw0KICAgICAgICAgICAgYXMucGVyaW9kKHVuaXQgPSAic2VjIikgJT4lICMgY29udmVydHMgZW50aXJlbHkgdG8gc2Vjb25kcw0KICAgICAgICAgICAgYXMubnVtZXJpYyAoKSkgIyBzdHJpcHMgdGhlIFMgc3ltYm9sIHRvIG1ha2UgaXQgYSBudW1iZXINCg0KIyMgQ3JlYXRlIHZhcmlhYmxlIHN0YWdlDQoNCmRhdCA8LSBkYXQlPiUNCiAgbXV0YXRlIChzdGFnZSA9IGN1dF9pbnRlcnZhbCh0aW1lLCBsZW5ndGggPSAyMTAsIGxhYmVscyA9IEZBTFNFKSkNCg0KIyMgQ3JlYXRlIHZhcmlhYmxlIG9mIHJvdyBudW1iZXJzDQoNCmRhdCA8LSBkYXQgJT4lDQogIGdyb3VwX2J5KHN0YWdlKSAlPiUNCiAgbXV0YXRlIChyb3dfaWQgPSByb3dfbnVtYmVyKCkpDQoNCiMjIFJlbW92ZSBsYXN0IDMwcyBkYXRhIHBlciBzdGFnZQ0KDQpkYXQgPC0gZGF0ICU+JQ0KICBncm91cF9ieShzdGFnZSkgJT4lICMgZm9yIGVhY2ggZ3JvdXANCiAgZmlsdGVyIChyb3dfaWQgPCAzNykgDQoNCiMjIGtlZXAgbGFzdCAzMHMgcGVyIHN0YWdlDQoNCmRhdCA8LSBkYXQgJT4lDQogIGdyb3VwX2J5KHN0YWdlKSAlPiUgIyBmb3IgZWFjaCBncm91cA0KICBzbGljZV90YWlsIChuID0gNikNCg0KIyMgU3VtbWFyaXplIGVhY2ggY29sdW1uDQpkYXQgPC0gZGF0ICU+JQ0KICBncm91cF9ieShzdGFnZSkgJT4lICMgZm9yIGVhY2ggZ3JvdXANCiAgc3VtbWFyaXNlX2F0ICh2YXJzKGJmOmhyKSwgbWVhbikNCg0KIyMgRXhwb3J0IGNsZWFuIHZvMiBkYXRhDQoNCndyaXRlLnhsc3goeCA9IGRhdCwNCiAgICAgICAgICAgZmlsZSA9ICJkYXRhL0F0aGxldGVfMV90cmVhZG1pbGxfY2xlYW4ueGxzeCIpDQoNCiMgQ3JlYXRlIGJhcnBsb3QNCg0KIyMgSW1wb3J0IEZNUyBkYXRhDQoNCmRhdF9mbXMgPC0gIHJlYWQueGxzeCAoeGxzeEZpbGUgPSAiZGF0YS9BdGhsZXRlXzFfRk1TLnhsc3giLA0KICAgICAgICAgICAgICAgICAgICAgICBzaGVldCA9ICJTaGVldDEiKQ0KDQojIyBGTVMgbWluaW11bSBzY29yZQ0KDQpkYXRfc3VtbSA8LSBkYXRfZm1zICU+JQ0KICBncm91cF9ieSh0YXNrKSAlPiUNCiAgc3VtbWFyaXplICh0b3RhbCA9IG1pbiAoc2NvcmUpKSANCg0KIyMgQmFycGxvdA0KDQpnZ3Bsb3QoZGF0X3N1bW0pICsgDQogIGdlb21fY29sKGFlcyh4ID0gdGFzaywgeSA9IHRvdGFsKSkNCg0KIyMgQ2hhbmdlIGJhcnBsb3QgY29sb3VyDQoNCmdncGxvdChkYXRfc3VtbSkgKyANCiAgZ2VvbV9jb2woYWVzKHggPSB0YXNrLCB5ID0gdG90YWwpLCBmaWxsID0gImJsdWUiLCBjb2xvdXIgPSAicmVkIikgDQoNCiMgQ3JlYXRlIGxpbmVwbG90DQoNCiMjIEltcG9ydCBkYXRhDQoNCmRhdCA8LSAgcmVhZC54bHN4ICh4bHN4RmlsZSA9ICJkYXRhL0F0aGxldGVfMV90cmVhZG1pbGwueGxzeCIsDQogICAgICAgICAgICAgICAgICAgc2hlZXQgPSAicmF3IikNCg0KZGF0X3N0YWdlIDwtICByZWFkLnhsc3ggKHhsc3hGaWxlID0gImRhdGEvQXRobGV0ZV8xX3RyZWFkbWlsbC54bHN4IiwNCiAgICAgICAgICAgICAgICAgICAgICAgICBzaGVldCA9ICJzdGFnZSIpDQoNCg0KIyMgUmVuYW1lIGNvbHVtbnMNCm5hbWVzIChkYXQpIDwtIGMoInRpbWUiLCAiYmYiLCAidm8yX25vcm0iLCAicmVyIiwgInZvMiIsICJ2Y28yIiwgInZlIiwgImhyIikNCg0KIyMgU2xpY2Ugb2ZmIGZpcnN0IHJvdw0KDQpkYXQgPC0gZGF0JT4lIA0KICBzbGljZSAoLTEpIA0KDQojIyBNYWtlIG51bWVyaWMgYW5kIHRpbWUNCg0KZGF0IDwtIGRhdCAlPiUNCiAgbXV0YXRlIChiZiA9IGFzLm51bWVyaWMoYmYpLA0KICAgICAgICAgIHZvMl9ub3JtID0gYXMubnVtZXJpYyh2bzJfbm9ybSksDQogICAgICAgICAgcmVyID0gYXMubnVtZXJpYyhyZXIpLA0KICAgICAgICAgIHZvMiA9IGFzLm51bWVyaWModm8yKSwNCiAgICAgICAgICB2Y28yID0gYXMubnVtZXJpYyh2Y28yKSwNCiAgICAgICAgICB2ZSA9IGFzLm51bWVyaWModmUpLA0KICAgICAgICAgIGhyID0gYXMubnVtZXJpYyhocikpICU+JQ0KICBtdXRhdGUgKHRpbWUgPSB0aW1lICU+JSANCiAgICAgICAgICAgIHN0cl9zcXVpc2goKSAlPiUgIyBmdW5jdGlvbiBzdHJpcHMgYW55IHdoaXRlc3BhY2VzDQogICAgICAgICAgICBtcygpICU+JSAjIGNvbnZlcnQgdG8gbWludXRlcyBhbmQgc2Vjb25kcw0KICAgICAgICAgICAgYXMucGVyaW9kKHVuaXQgPSAic2VjIikgJT4lICMgY29udmVydHMgZW50aXJlbHkgdG8gc2Vjb25kcw0KICAgICAgICAgICAgYXMubnVtZXJpYyAoKSkgIyBzdHJpcHMgdGhlIFMgc3ltYm9sIHRvIG1ha2UgaXQgYSBudW1iZXINCg0KIyMgQ3JlYXRlIHZhcmlhYmxlIHN0YWdlDQoNCmRhdCA8LSBkYXQlPiUNCiAgbXV0YXRlIChzdGFnZSA9IGN1dF9pbnRlcnZhbCh0aW1lLCBsZW5ndGggPSAyMTAsIGxhYmVscyA9IEZBTFNFKSkNCg0KIyMgQ3JlYXRlIHZhcmlhYmxlIG9mIHJvdyBudW1iZXJzDQoNCmRhdCA8LSBkYXQgJT4lDQogIGdyb3VwX2J5KHN0YWdlKSAlPiUNCiAgbXV0YXRlIChyb3dfaWQgPSByb3dfbnVtYmVyKCkpDQoNCiMjIFJlbW92ZSBsYXN0IDMwcyBkYXRhIHBlciBzdGFnZQ0KDQpkYXQgPC0gZGF0ICU+JQ0KICBncm91cF9ieShzdGFnZSkgJT4lICMgZm9yIGVhY2ggZ3JvdXANCiAgZmlsdGVyIChyb3dfaWQgPCAzNykgDQoNCiMjIGtlZXAgbGFzdCAzMHMgcGVyIHN0YWdlDQoNCmRhdCA8LSBkYXQgJT4lDQogIGdyb3VwX2J5KHN0YWdlKSAlPiUgIyBmb3IgZWFjaCBncm91cA0KICBzbGljZV90YWlsIChuID0gNikNCg0KIyMgU3VtbWFyaXplIGVhY2ggY29sdW1uDQpkYXRfc3VtbSA8LSBkYXQgJT4lDQogIGdyb3VwX2J5KHN0YWdlKSAlPiUgIyBmb3IgZWFjaCBncm91cA0KICBzdW1tYXJpc2VfYXQgKHZhcnMoYmY6aHIpLCBtZWFuKQ0KDQojIyBNZXJnZSBkYXRhcw0KDQpkZl9wbG90IDwtIGRhdF9zdW1tICU+JQ0KICBpbm5lcl9qb2luKGRhdF9zdGFnZSwgYnkgPSAic3RhZ2UiKQ0KDQojIyBQbG90DQoNCmYgPC0gZ2dwbG90KGRmX3Bsb3QgKSArDQogICAgIGdlb21fbGluZShhZXMoeCA9IHN0YWdlLCB5ID0gdm8yKSkNCg0KIyMgU2F2ZQ0KDQpnZ3NhdmUoZmlsZW5hbWUgPSAibXlmaWcucG5nIiwgDQogICAgICAgcGxvdCA9IGYsICMgdGhlIG5hbWUgb2YgdGhlIGltYWdlIG9iamVjdCB5b3UgY3JlYXRlZCBhYm92ZS4NCiAgICAgICB3aWR0aCA9IDgsIA0KICAgICAgIGhlaWdodCA9IDgsIA0KICAgICAgIHVuaXQgPSAiY20iLCANCiAgICAgICBkcGkgPSAzMDAp').then(res =&gt; res.blob()).then(blob =&gt; {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'Learning check 8 answers.R'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
    });">
<button class="btn btn-warning" output_extension=".R"><i class="fa fa-save"></i> Learning check 8 answers</button>
</a>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="CHAPTER-BAR-GRAPH.html"><span class="header-section-number">8</span> Bar Graphs</a></div>
<div class="next"><a href="your-assignment.html"><span class="header-section-number">10</span> Your Assignment</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#line-graphs"><span class="header-section-number">9</span> Line Graphs</a></li>
<li>
<a class="nav-link" href="#LINE-GRAPH-BASIC-LINE"><span class="header-section-number">9.1</span> Making a Basic Line Graph</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#problem-23"><span class="header-section-number">9.1.1</span> Problem</a></li>
<li><a class="nav-link" href="#solution-23"><span class="header-section-number">9.1.2</span> Solution</a></li>
<li><a class="nav-link" href="#discussion-12"><span class="header-section-number">9.1.3</span> Discussion</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#LINE-GRAPH-MULTIPLE-LINE"><span class="header-section-number">9.2</span> Making a Line Graph with Multiple Lines</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#problem-24"><span class="header-section-number">9.2.1</span> Problem</a></li>
<li><a class="nav-link" href="#solution-24"><span class="header-section-number">9.2.2</span> Solution</a></li>
<li><a class="nav-link" href="#discussion-13"><span class="header-section-number">9.2.3</span> Discussion</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#LINE-GRAPH-LINE-APPEARANCE"><span class="header-section-number">9.3</span> Changing the Appearance of Lines</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#problem-25"><span class="header-section-number">9.3.1</span> Problem</a></li>
<li><a class="nav-link" href="#solution-25"><span class="header-section-number">9.3.2</span> Solution</a></li>
<li><a class="nav-link" href="#discussion-14"><span class="header-section-number">9.3.3</span> Discussion</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#LINE-GRAPH-APPEARANCE-THEME"><span class="header-section-number">9.4</span> Using Themes to Change Overall Appearance of Plot</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#problem-26"><span class="header-section-number">9.4.1</span> Problem</a></li>
<li><a class="nav-link" href="#solution-26"><span class="header-section-number">9.4.2</span> Solution</a></li>
</ul>
</li>
<li><a class="nav-link" href="#LINE-GRAPH-LEARNING-CHECK"><span class="header-section-number">9.5</span> Learning check</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/bernard-liew/se201_stats_book/tree/2021_version/blob/master/07-lineplot.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/bernard-liew/se201_stats_book/tree/2021_version/edit/master/07-lineplot.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Simple Cookbook for Wrangling and Visualization</strong>" was written by Bernard Liew. It was last built on 2022-10-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
